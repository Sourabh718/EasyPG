<%- include('../partials/head') %>
<link rel="stylesheet" href="/css/home.css">
</head>
<body class="bg-gradient-to-r from-gray-100 via-gray-50 to-gray-100 text-gray-800">
  <%- include('../partials/nav') %>
  <style>
    .X{
      float: right;
      cursor: pointer;
      font-weight: bold;
      font-size: 25px;
      padding: 0%;
      color: red;
    }
  </style>

  <main class="container mx-auto px-6 py-12 max-w-6xl">
    <section class="bg-white  p-50 rounded-2xl p-10 mt-10">
      <h2 class="fs-1 text-danger fw-bold text-start mb-4 ps-4">Requests</h2>
        <% if (request.length === 0) { %>
        <div class="no-requests">
            <img src="../image/4076549.png" alt="No Requests" class="no-requests-img image">
            <h3>No Requests Found</h3>
            <p>
            It looks like you havenâ€™t received any requests yet.  
            Stay tuned â€” theyâ€™ll appear here once users send them!
            </p>
            <a href="/host/home-list" class="back-btn">ðŸ”™ Back to Dashboard</a>
        </div>
        <% } else{ %>
        <div class="page-container">
        <% request.forEach(req=>{%>
        <div class="mb-10  pb-4 request-container" >
          <form action="/host/request-delete/<%= req._id %>" method="post">
            <!-- <span class="X" onclick="this.parentElement.style.display='none';">&times;</span> -->
            <button class="X" type="submit">&times;</button>
          </form>
            
            <h3 class="text-xl font-semibold text-gray-800 mb-3">From: <span class="text-primary"><%=req.email%></span></h3>
            <h4 class="text-lg font-medium text-gray-700 mb-2">Message: <span class="text-secondary"><%=req.message%></span></h4>

          
            <form action="/host/request-respond/<%= req._id %>" method="POST" class="mt-3">
            <textarea name="response" placeholder="Type your response..." rows="2" style="width:100%; border: 1px solid rgb(122, 118, 118);border-radius: 5px; padding: 6px;" required></textarea>
            <button type="submit" class="btn btn-sm btn-success mt-2 response-btn" id="response">Respond</button>
          </form>
        </div>
       <% })} %>
       </div>
    </section>
  </main> 
  <script>
   const buttons = document.querySelectorAll('.response-btn');
   buttons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault(); // stop instant submission
      btn.innerText = 'Responding...';
      btn.disabled = true;

      setTimeout(() => {
        btn.closest('form').submit();
      }, 1);
    });
  });
  </script>
  <%- include('../partials/footer') %>
</body>
</html>
